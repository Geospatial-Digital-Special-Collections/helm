{{- if eq $.Values.gdsc.storage.provisioner "local-storage" -}}

# local storage for development
{{- if eq (lookup "v1" "StorageClass" "gdsc" "local-storage") nil -}}
# local storage class
{{ range $path, $_ :=  .Files.Glob  "storage/local/*.yaml" }}
  {{- $.Files.Get $path }}
---
{{ end }}
{{- end -}}
# all local pvs
{{ range $path, $_ :=  .Files.Glob  "storage/local/volumes/*pv.yaml" }}
  {{- $.Files.Get $path | replace "__path__" $.Values.storage.path }}
---
{{ end }}
# all local pvcs
{{ range $path, $_ :=  .Files.Glob  "storage/local/claims/*pvc.yaml" }}
  {{- $.Files.Get $path }}
---
{{ end }}

{{- else }}

# cluster scoped storage: rook-ceph or longhorn provisioners
{{ range $path, $_ :=  .Files.Glob  "storage/cluster/*pvc.yaml" }}
  {{- $.Files.Get $path }}
---
{{ end }}

{{ end }}